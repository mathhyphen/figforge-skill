Methodology Section - Deep Learning Framework Draft Text for Manuscript (English) 2.4. Deep Learning-Accelerated Optical Simulation via Flow Matching 2.4.1. Theoretical Foundation: Continuous Normalizing Flows To overcome the computational bottleneck of traditional Monte Carlo (MC) simulations, we employed Flow Matching (FM), a novel generative paradigm that outperforms traditional diffusion models in training efficiency and sampling speed. Unlike standard diffusion models that approximate a stochastic reverse process, Flow Matching deterministically learns a time-dependent vector field v(x) that pushes a probability density path p from a simple source distribution p (e.g., Gaussian noise or a preliminary approximation) to a complex target distribution p(e.g., the high-fidelity photon energy deposition field). Formally, we define a flow φ(x) driven by the vector field v, which satisfies the ordinary differential equation (ODE): The objective is to regress the vector field v such that the push-forward density matches the target data distribution. We utilize Conditional Flow Matching (CFM), where the generation process is guided by specific conditions c (e.g., simulation parameters or low-dose inputs). The loss function is defined as the expectation over the data and time: where v is the neural network (U-Net architecture), and u is the target vector field constructing the optimal transport path between the source and target. 2.4.2. A Paradigm Shift: From "Anatomy-to-Flux" to "Flux-to-Flux" Mapping Traditional deep learning approaches for optical dosimetry typically follow an "Anatomy-to-Flux" paradigm, where the model learns to map discrete anatomical segmentation maps (S) directly to continuous energy deposition fields (E = f(S, params)). While intuitive, this approach suffers from significant limitations: Cross-Modal Complexity: Mapping discrete, categorical tissue labels to continuous physical gradients is a highly non-linear and difficult optimization task. Template Dependency & Bias: Human scalp and skull optical properties vary significantly across ethnicities (e.g., differences in melanin content between Asian, Caucasian, and African populations). A model trained on a specific segmentation template or demographic binds the simulation to that specific anatomical representation, lacking generalization. Error Propagation: The accuracy of the simulation becomes strictly limited by the quality of the upstream segmentation tool (e.g., CAT12 vs. SynthSeg). To address these challenges, we propose a novel "Flux-to-Flux" framework. Instead of conditioning on anatomy, we introduce a Fast Sparse Simulation step. We perform a rapid, low-dose MC simulation (E) using only 10 photons (computation time ≈ 1 second on a standard CPU). The Flow Matching model then learns the same-modal mapping from this noisy, sparse approximation to the converged, high-fidelity field (E): 2.4.3. Advantages of the Proposed Framework Template Independence: Since the input E already contains the physical scattering and absorption information derived from the individual's specific anatomy, the deep learning model does not need to "see" the segmentation map explicitly. This makes the method robust to variations in head shape, skin tone, or segmentation protocols. Reduced Training Complexity: The transformation from a noisy physics field to a clean physics field is a denoising and super-resolution task, which is significantly easier for Convolutional Neural Networks (CNNs) to learn than translating anatomy to physics. High-Fidelity Training Data: To minimize systematic errors, our training dataset was generated using the CHARM (Comprehensive Head Atlas for Radiation Medicine) mesh-based models, distinguishing 10 distinct tissue types. This ensures that the ground truth (E) captures subtle optical interactions that standard 5-tissue segmentation models often miss.